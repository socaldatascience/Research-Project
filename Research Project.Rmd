---
title: "Child Patients with Covid-19 and Cystic Fibrosis"
author: "Alfonso Vieyra"
date: '2022-06-30'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1

## Part 2

## Part 3

```{r}
library(tidyverse)
filter(d, has_cf == 1)
sub_df <- filter(d, has_cf == 1)
nonsub_df <- filter(d, has_cf == 0)
```

```{r}
d %>%
  select(COVIDseverity, comorb_lung_transplant_Z942) %>%
  table()

```

```{r}
sub_df %>%
  select(COVIDseverity, comorb_lung_transplant_Z942) %>%
  table()
  
```

```{r}
hr <- filter(d, heartrate <= 220)
ppp <- ggplot(hr, aes(x = COVIDseverity, y = heartrate, fill = has_cf)) +
  geom_boxplot() + 
  ggtitle("Covid 19 Severity Based on Patients Heartrate")
  scale_fill_manual(labels = c("Covid 19 Severity", "Heartrate of the Patient"))
ppp <- ppp + guides(fill=guide_legend(title="CF Indicator"))
ppp
```

```{r}
p <- ggplot(sub_df, aes(x = COVIDseverity, fill = race)) +
  geom_bar() + 
  labs(x = "Covid 19 Severity",
       y = "Number of Patients",
       title = "Covid 19 Severity Within each Race of Patients with CF")
p <- p + guides(fill=guide_legend(title="Race"))
p
```

```{r}
pp <- ggplot(nonsub_df, aes(x = COVIDseverity, fill = race)) +
  geom_bar() + 
  labs(x = "Covid 19 Severity",
       y = "Number of Patients",
       title = "Covid 19 Severity Within each Race of Patients without CF")
pp <- pp + guides(fill=guide_legend(title="Race"))
pp
```

## Part 4

## Part 5