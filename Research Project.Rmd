---
title: "Child Patients with Covid-19 and Cystic Fibrosis"
author: "Alfonso Vieyra"
date: '2022-06-30'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(tidyverse)
library(ggplot2)
library(scales)
```

## Part 1

## Part 2

## Part 3

## Part 4

## Part 5
```{r}
non_cf <- d %>%
  filter(has_cf == 0)
```
```{r}
non_cf %>% 
  ggplot(aes(x=COVIDseverity)) +
  geom_bar(fill = "magenta")
```
```{r}
  d %>% 
  select(has_cf, COVIDseverity) %>% 
  table()
```
```{r}
non_cf %>% 
  select(age_at_encounter, ethnicity) %>% 
  table()
```
```{r}
non_cf %>%
 group_by(COVIDseverity) %>%
 count()
```
```{r}
non_cf %>% 
  select(COVIDseverity, ethnicity) %>% 
  table()
```
```{r}
non_cf %>% 
  select(COVIDseverity, zip_code) %>% 
  table()
```
```{r}
non_cf %>% 
  select(COVIDseverity, race) %>% 
  table()
```
```{r}
non_cf %>% 
  select(COVIDseverity, encountertype) %>% 
  table()
```
```{r}
non_cf %>% 
  ggplot(aes(x=COVIDseverity,
             y=age_at_encounter, fill = COVIDseverity)) +
  geom_boxplot() +
  labs(x = "COVID Severity", 
       y = "Age at Encounter", 
       title = "COVID Severity among children without Cystic Fibrosis") +
  scale_fill_manual(values =c("#E69F00","#009E73","#56B4E9"))
```
```{r}
non_cf %>% 
  ggplot(aes(x=COVIDseverity, fill = race)) +
  geom_bar()
```
```{r}
d %>% 
  ggplot(aes(x=COVIDseverity,
             y=age_at_encounter, 
             fill = has_cf)) +
  geom_boxplot() +
  labs(x = "COVID Severity", y = "Age at Encounter") +
  ggtitle("COVID Severity Among Children based on Age") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values =c("#E69F00","#009E73"), 
                    labels = c("Non CF","CF"), 
                    name = "Cystic Fibrosis Diagnosis") 
```
```{r}
non_cf %>% 
  ggplot(aes(x=race, fill = COVIDseverity)) +
  geom_bar(position = "dodge") + 
  coord_flip() +
  labs(x = "Race", y = "Count") +
  ggtitle("COVID Severity Among Children based on Race") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values =c("#E69F00","#009E73","#56B4E9"), 
                    labels = c("Asymptomatic","Moderate","Severe"),
                    name = "COVID Severity") +
  scale_y_continuous(labels = comma)
```
```{r}
non_cf %>% 
  ggplot(aes(x=ethnicity, fill = COVIDseverity)) +
  geom_bar(position = "dodge") +
  labs(x = "Ethnicity", y = "Count") +
  ggtitle("COVID Severity Among Children based on Ethnicity") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_manual(values =c("#E69F00","#009E73","#56B4E9"), 
                    labels = c("Asymptomatic","Moderate","Severe"),
                    name = "COVID Severity") +
  scale_y_continuous(labels = comma)
```

